lines(x = density(u), col = "blue")
u <- rnorm(1000)
plot(NULL, ylab="density", xlab="value", main="Bimodal and unimodal data",
xlim=c(-5, 5), ylim=c(0, 0.7))
lines(x = density(b), col = "red")
lines(x = density(u), col = "blue")
u <- rnorm(1000000)
plot(NULL, ylab="density", xlab="value", main="Bimodal and unimodal data",
xlim=c(-5, 5), ylim=c(0, 0.7))
lines(x = density(b), col = "red")
lines(x = density(u), col = "blue")
u <- rnorm(1000000)
b1 <- rnorm(500000,1,0.5)
b2 <- rnorm(500000,-1,0.5)
b <- c(b1,b2)
plot(NULL, ylab="density", xlab="value", main="Bimodal and unimodal data",
xlim=c(-5, 5), ylim=c(0, 0.7))
lines(x = density(b), col = "red")
lines(x = density(u), col = "blue")
plot(NULL, ylab="density", xlab="value",
xlim=c(-5, 5), ylim=c(0, 0.7))
lines(x = density(b), col = "red")
lines(x = density(u), col = "blue")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(stringi)
df_cas <- read.csv("updated_CAS.csv")
df_police <- read.csv("updated_FullRoadSearch.csv")
df_cas <- cbind(df_cas,intoxication,speed,aggression)
df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = "Yes")
library(stringr)
df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = "Yes")
head(df_cas)
df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = Yes)
df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 1)
head(df_cas)
df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220"))
df_cas %>% mutate(intoxication = NA, speed = NA, aggression = NA)
head(df_cas)
df_cas <- df_cas %>% mutate(intoxication = NA, speed = NA, aggression = NA)
df_cas <- df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 1)
head(df_cas,100)
tail(df_cas,10)
df_cas <- read.csv("updated_CAS.csv")
df_cas <- df_cas %>% mutate(intoxication = NA, speed = NA, aggression = NA)
df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 1)
head(df_cas,10)
df_cas_intox <- df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 1)
df_cas_nontox <- df_cas %>% filter(!str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 0)
df_cas <- rbind(df_cas_intox,df_cas_nontox)
head(df_cas)
df_cas <- read.csv("updated_CAS.csv")
df_cas_intox <- df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 1)
df_cas_nontox <- df_cas %>% filter(!str_detect(Vehicle.1.contributing.factor,"101|103|105|100|108|109|221|220")) %>% mutate(intoxicaton = 0)
df_cas <- rbind(df_cas_intox,df_cas_nontox)
head(df_cas)
tail(df_cas)
df_cas_speed <- df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"111|112|113|115|116|117|118|119|110")) %>% mutate(speed = 1)
df_cas_nonspeed <- df_cas %>% filter(!str_detect(Vehicle.1.contributing.factor,"111|112|113|115|116|117|118|119|110")) %>% mutate(speed = 0)
df_cas <- rbind(df_cas_speed,df_cas_nonspeed)
df_cas <- rbind(df_cas_speed,df_cas_nonspeed)
head(df_cas)
tail(df_cas)
tail(df_cas_speed)
df_cas_aggro <- df_cas %>% filter(str_detect(Vehicle.1.contributing.factor,"141|145|140|151|152|156|157|158|159|160|150|171|173|174|176|177|179|184|170|181|183|180|191|192|190|201|202|204|208|200|321|322|324|326|327|328|320|301|303|304|306|308|309|312|313|314|315|316|300|357|351|350|431|432|433|434|430|511|512|514|515|518|510")) %>% mutate(aggression = 1)
df_cas_nonaggro <- df_cas %>% filter(!str_detect(Vehicle.1.contributing.factor,"141|145|140|151|152|156|157|158|159|160|150|171|173|174|176|177|179|184|170|181|183|180|191|192|190|201|202|204|208|200|321|322|324|326|327|328|320|301|303|304|306|308|309|312|313|314|315|316|300|357|351|350|431|432|433|434|430|511|512|514|515|518|510")) %>% mutate(aggression = 0)
df_cas <- rbind(df_cas_aggro,df_cas_nonaggro)
summarise(df_cas)
summary(df_cas)
df_police %>% mutate(across(c(Scene_Station,Urban_Non_Urban_by_ESZ,Call_Source,Priority,Closure_Type_Code,Closure_Priority), as.factor))
df_cas %>% mutate(across(c(Crash.severity,Simple...complex.crash,Police.attended,Watch.house,Holiday,Is.weekend,Police.station,Road.category,Intersection...midblock,Intersection,On.state.highway,Urban.or.open.speed.zone,Movement.codes.categories,Road.Safety.report.movement.group,Junction.type,Rail.crossing.controls,Road.curvature,Gradient,Surface.type,Road.type,Special.purpose.lane, Street.lights, Traffic.control.present,Primary.surface.condition, Road.markings, Natural.Light, Primary.weather, Secondary.weather),as.factor))
summary(df_cas)
df_police <- df_police %>% mutate(across(c(Scene_Station,Urban_Non_Urban_by_ESZ,Call_Source,Priority,Closure_Type_Code,Closure_Priority), as.factor))
df_cas <- df_cas %>% mutate(across(c(Crash.severity,Simple...complex.crash,Police.attended,Watch.house,Holiday,Is.weekend,Police.station,Road.category,Intersection...midblock,Intersection,On.state.highway,Urban.or.open.speed.zone,Movement.codes.categories,Road.Safety.report.movement.group,Junction.type,Rail.crossing.controls,Road.curvature,Gradient,Surface.type,Road.type,Special.purpose.lane, Street.lights, Traffic.control.present,Primary.surface.condition, Road.markings, Natural.Light, Primary.weather, Secondary.weather),as.factor))
summary(df_cas)
write.csv(df_cas,"C:\\Users\\sagea\\Documents\\MINZ\\final_CAS.csv",row.names = F)
write.csv(df_police,"C:\\Users\\sagea\\Documents\\MINZ\\final_FullRoadSearch.csv",row.names = F)
dsi_cas <- df_cas %>% filter(Crash.severity = "Fatal Crash|Serious Crash")
dsi_cas <- df_cas %>% filter(Crash.severity == "Fatal Crash|Serious Crash")
dsi_cas <- df_cas %>% filter(Crash.severity == "Serious Crash" | Crash.severity == "Fatal Crash")
write.csv(df_cas,"C:\\Users\\sagea\\Documents\\MINZ\\DSI_only_CAS
.csv",row.names = F)
write.csv(dsi_cas,"C:\\Users\\sagea\\Documents\\MINZ\\DSI_only_CAS
.csv",row.names = F)
write.csv(dsi_cas,"C:\\Users\\sagea\\Documents\\MINZ\\DSI_only_CAS
.csv", row.names = F)
write.csv(dsi_cas,"C:\\Users\\sagea\\Documents\\MINZ\\DSI_only_CAS.csv", row.names = F)
summary(df_police)
police_presence <- df_police %>% filter(Closure_Type_Code = "1U|3R|3T|3W|6I")
police_presence <- df_police %>% filter(Closure_Type_Code == "1U|3R|3T|3W|6I")
police_presence <- df_police %>% filter(Closure_Type_Code == "1U" | Closure_Type_Code == "3R" | Closure_Type_Code == "3T" |Closure_Type_Code == "3W" | Closure_Type_Code == "6I")
summary(police_presence)
write.csv(police_presence,"C:\\Users\\sagea\\Documents\\MINZ\\1U_3T_3R_3W_6I_presence_FullRoadSearch.csv", row.names = F)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(sf)
library(rnaturalearth)
library(osmdata)
library(rnaturalearthdata)
library(dplyr)
library(lubridate)
df_crash <- read.csv("final_CAS.csv")
df_police <- read.csv("final_FullRoadSearch")
df_police <- read.csv("final_FullRoadSearch.csv")
# Path to your shapefile
shapefile_path <- "new-zealand-latest-free.shp"
layers_info <- st_layers(shapefile_path)
print(layers_info)
# Path to your shapefile
shapefile_path <- "C:\\Users\\sagea\\Documents\\MINZ\\new-zealand-latest-free.shp"
layers_info <- st_layers(shapefile_path)
print(layers_info)
# Read the shapefile
nz_map <- st_read(shapefile_path, layer="gis_osm_roads_free_1")
chch_bbox <- st_bbox(c(xmin = 172.42, ymin = -43.71, xmax = 172.80, ymax = -43.41), crs = st_crs(nz_map))
# Filter the roads data to only include features within the bounding box
roads_chch <- st_crop(nz_map, chch_bbox) %>%
filter(fclass %in% c("trunk", "primary", "secondary", "tertiary")) # primary, secondary, tertiary, motorway
# Filter the roads data to only include features within the bounding box
roads_chch <- st_crop(nz_map, chch_bbox) %>%
filter(fclass %in% c("trunk", "primary", "secondary", "tertiary")) # primary, secondary, tertiary, motorway
# Print the first few rows of the filtered data
print(head(roads_chch))
df_police <- read.csv("latlong_FullRoadSearch.csv")
df_police <- read.csv("latlong_updated_FullRoadSearch.csv")
```{r fig.height=10, fig.width=10}
ggplot() +
geom_bin2d(data=df_crash, aes(x=Longitude, y=Latitude), bins=100, ) +
geom_sf(data = roads_chch, color = "blue", size = 0.5) +
scale_fill_gradient(low="lightblue1",high="darkblue")+
theme_minimal() +
labs(title = "Accidents",
x = "Longitude", y = "Latitude") +
theme(
plot.title = element_text(hjust = 0.5, size = 20, face = "bold"),
axis.title = element_text(size = 15)
)
library(proj4)
library(maps)
library(mapproj)
proj4string <- "+proj=tmerc +lat_0=0.0 +lon_0=173.0 +k=0.9996 +x_0=1600000.0 +y_0=10000000.0 +datum=WGS84 +units=m"
nr = 1000000
p <- project(rbind(df_police[, "Easting"], df_police[, "Northing"]), proj=proj4string, inverse=T)
df_police$Longitude = p[,1]
df_police$Latitude = p[,2]
# for (nr in (1:nrow(df_police))){
#   east <- df_police[nr, "NZTM_Easting"]
#   north <- df_police[nr, "NZTM_Northing"]
#   p <- project(c(east, north), proj=proj4string, inverse=T)
#   df_police[nr, "longitude"] = p[1]
#   df_police[nr, "latitude"] = p[2]
#
# }
df_police <- read.csv("final_FullRoadSearch.csv")
library(proj4)
library(maps)
library(mapproj)
proj4string <- "+proj=tmerc +lat_0=0.0 +lon_0=173.0 +k=0.9996 +x_0=1600000.0 +y_0=10000000.0 +datum=WGS84 +units=m"
nr = 1000000
p <- project(rbind(df_police[, "Easting"], df_police[, "Northing"]), proj=proj4string, inverse=T)
df_police$Longitude = p[,1]
p <- project(rbind(df_police[, "Easting"], df_police[, "Northing"]), proj=proj4string, inverse=T)
df_police$Longitude = p[,1]
df_police <- read.csv("final_FullRoadSearch.csv")
df_police <- read.csv("final_FullRoadSearch.csv")
library(proj4)
library(proj4)
library(maps)
library(mapproj)
proj4string <- "+proj=tmerc +lat_0=0.0 +lon_0=173.0 +k=0.9996 +x_0=1600000.0 +y_0=10000000.0 +datum=WGS84 +units=m"
nr = 1000000
p <- project(rbind(df_police[, "Easting"], df_police[, "Northing"]), proj=proj4string, inverse=T)
df_police$Longitude = p[,1]
df_police$Latitude = p[,2]
df_police <- read.csv("final_FullRoadSearch.csv")
library(proj4)
library(maps)
library(mapproj)
proj4string <- "+proj=tmerc +lat_0=0.0 +lon_0=173.0 +k=0.9996 +x_0=1600000.0 +y_0=10000000.0 +datum=WGS84 +units=m"
nr = 1000000
p <- project(rbind(df_police[, "Easting"], df_police[, "Northing"]), proj=proj4string, inverse=T)
df_police$Longitude = p[,1]
df_police$Latitude = p[,2]
write.csv(df_police,"final_FullRoadSearch.csv")
police_presence <- df_police %>% filter(Closure_Type_Code == "1U" | Closure_Type_Code == "3R" | Closure_Type_Code == "3T" |Closure_Type_Code == "3W" | Closure_Type_Code == "6I")
summary(police_presence)
summary(df_police)
write.csv(police_presence,"C:\\Users\\sagea\\Documents\\MINZ\\1U_3T_3R_3W_6I_presence_FullRoadSearch.csv", row.names = F)
df_police <- read.csv("up_updated_FullRoadSearch.csv")
df_police <- read.csv("up_updated_FullRoadSearch_2.0.csv")
summary(df_police)
df_police <- read.csv("up_updated_FullRoadSearch_2.0.csv")
library(proj4)
library(maps)
library(mapproj)
proj4string <- "+proj=tmerc +lat_0=0.0 +lon_0=173.0 +k=0.9996 +x_0=1600000.0 +y_0=10000000.0 +datum=WGS84 +units=m"
nr = 1000000
p <- project(rbind(df_police[, "Easting"], df_police[, "Northing"]), proj=proj4string, inverse=T)
df_police$Longitude = p[,1]
df_police$Latitude = p[,2]
write.csv(df_police,"up_updated_FullRoadSearch-2.0-with-latlong.csv")
write.csv(df_police,"up_updated_FullRoadSearch-2.0-with-latlong.csv", row.names = F)
write.csv(df_police,"up_updated_FullRoadSearch-2.0-with-latlong.csv", row.names = F)
write.csv(df_police,"up_updated_FullRoadSearch-2_0-with-latlong.csv", row.names = F)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(sf)
library(rnaturalearth)
library(osmdata)
library(rnaturalearthdata)
library(dplyr)
library(lubridate)
df_crash <- read.csv("final_CAS.csv")
df_police <- read.csv("latlong_updated_FullRoadSearch.csv")
# Path to your shapefile
shapefile_path <- "C:\\Users\\sagea\\Documents\\MINZ\\new-zealand-latest-free.shp"
layers_info <- st_layers(shapefile_path)
print(layers_info)
# Read the shapefile
nz_map <- st_read(shapefile_path, layer="gis_osm_roads_free_1")
#nz_map_landuse <- st_read(shapefile_path, layer="gis_osm_natural_a_free_1")
chch_bbox <- st_bbox(c(xmin = 172.42, ymin = -43.71, xmax = 172.80, ymax = -43.41), crs = st_crs(nz_map))
# Filter the roads data to only include features within the bounding box
roads_chch <- st_crop(nz_map, chch_bbox) %>%
filter(fclass %in% c("trunk", "primary", "secondary", "tertiary")) # primary, secondary, tertiary, motorway
landuse_chch <- st_crop(nz_map_landuse, chch_bbox)
intox <- df_crash %>% filter(intoxication == 1)
intox <- df_crash %>% filter(intoxicaton,1)
intox <- df_crash %>% filter(intoxicaton,"1")
intox <- df_crash %>% filter(intoxicaton,TRUE)
intox <- df_crash %>% filter(intoxicaton == 1)
intox_crashmap <- gglot(data=roads_chch,aes(long,lat))
intox_crashmap <- ggplot(data=roads_chch,aes(long,lat))
intox_crashmap
df_crash <- read.csv("final_CAS.csv")
df_police <- read.csv("up_updated_FullRoadSearch-2_0-with-latlong.csv")
intox <- df_crash %>% filter(intoxicaton == 1)
intox <- df_crash %>% filter(Crash.severity == "Fatal Crash" |Crash.severity == "Serious Crash")
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=lng, y=lat), color = "red")
intox_crashmap
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude)), color = "red")
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap
intox_crashmap
intox <- df_crash %>% filter(Crash.severity == "Fatal Crash" | Crash.severity == "Serious Crash" & intoxication == 1)
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox <- df_crash %>% filter(Crash.severity == "Fatal Crash" | Crash.severity == "Serious Crash" & intoxication == 1)
intox <- df_crash %>% filter(intoxicaton == 1)
intox <- intox %>% filter(Crash.severity == "Fatal Crash" | Crash.severity == "Serious Crash")
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap
intox_crashmap
3R <- df_police %>% filter(Closure.Type.Code == "3R")
checkpoints<- df_police %>% filter(Closure.Type.Code == "3R")
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
#geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
geom_point(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green")
intox
intox_crashmap
summary(checkpoints)
size(checkpoints)
length(checkpoints$Closure.Type.Code)
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
#geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
#geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green")
intox_crashmap <- ggplot() +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green")
intox_crashmap
intox_crashmap <- ggplot() +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
geom_sf(data = roads_chch) +
#geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green")
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap
intox_crashmap <- ggplot() +
#geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green")
intox_crashmap
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap <- ggplot() +
#geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green")
intox_crashmap <- ggplot() +
#geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
geom_sf(data = roads_chch) +
geom_bin2d(data=checkpoints, aes(x=Longitude, y=Latitude), color = "green") +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red")
intox_crashmap
intox <- df_crash %>% filter(intoxication == 1)
intox <- df_crash %>% filter(intoxicaton == 1)
map_intox <- ggplot() +
geom_bin2d(data=intox, aes(x=Longitude, y=Latitude), color = "green") +
geom_sf(data = roads_chch)
map_intox
map_intox <- ggplot() +
geom_bin2d(data=intox, aes(x=Longitude, y=Latitude), color = "green") +
geom_sf(data = roads_chch) +
scale_fill_gradient(low="green4",high="green")
map_intox
map_intox <- ggplot() +
geom_bin2d(data=intox, aes(x=Longitude, y=Latitude), color = "blue") +
geom_sf(data = roads_chch) +
scale_fill_gradient(low="lightblue1",high="darkblue")
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "blue", alpha = 1/5)
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "blue", alpha = 1/20)
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "blue", alpha = 1/10)
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "blue", alpha = 1/10, size = 0.5)
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "blue", alpha = 1/10, size = 1)
map_intox
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "red", alpha = 1/10, size = 1)
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green", alpha = 1/10, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green2", alpha = 1/10, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/10, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/8, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch, alpha = 1/5) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/8, size = 1) +
ggtitle("Intoxication crashes")
map_intox <- ggplot() +
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch, alpha = 1/2) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/8, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_intox <- ggplot() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/8, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_intox <- ggplot() +
theme_classic()
map_intox <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/8, size = 1) +
ggtitle("Intoxication crashes")
map_intox
map_speed <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "steelblue", alpha = 1/8, size = 1) +
ggtitle("Speed crashes")
map_speed
map_speed <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "blue3", alpha = 1/8, size = 1) +
ggtitle("Speed crashes")
map_speed
speed <- df_crash %>% filter(speed == 1)
map_speed <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=speed, aes(x=Longitude, y=Latitude), color = "blue3", alpha = 1/8, size = 1) +
ggtitle("Speed crashes")
map_speed
map_intox <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=intox, aes(x=Longitude, y=Latitude), color = "green3", alpha = 1/8, size = 1) +
ggtitle("Intoxication crashes")
intox <- df_crash %>% filter(aggression == 1)
aggression <- df_crash %>% filter(aggression == 1)
intox <- df_crash %>% filter(intoxicaton == 1)
speed <- df_crash %>% filter(speed == 1)
aggression <- df_crash %>% filter(aggression == 1)
map_aggression <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=aggression, aes(x=Longitude, y=Latitude), color = "red3", alpha = 1/8, size = 1) +
ggtitle("Aggression crashes")
map_aggression
map_intox
map_speed <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=speed, aes(x=Longitude, y=Latitude), color = "blue3", alpha = 1/8, size = 1) +
ggtitle("Speed crashes")
map_speed
map_aggression <- ggplot() +
theme_classic() +
geom_sf(data = roads_chch, alpha = 1/4) +
geom_point(data=aggression, aes(x=Longitude, y=Latitude), color = "red3", alpha = 1/8, size = 1) +
ggtitle("Aggression crashes")
map_aggression
setwd("~/GitHub/ABM_polarisation/ABM data")
tolerance_test <- read.csv("tolerance-test-100-runs.csv",header = T)
tolerance_test$Tolerance_factor <- as.factor(tolerance_test$Tolerance)
group_size_test <- read.csv("group_size_1000_steps.csv",header=T)
group_size_test$Size_factor <- as.factor(group_size_test$Size)
group_size_test$Tolerance_factor <- as.factor(group_size_test$Tolerance)
asymmetric <- read.csv("asymmetric-tolerance.csv",header=T)
asymmetric$g1_t_factor <- as.factor(asymmetric$g1_t)
asymmetric$g2_t_factor < - as.factor(asymmetric$g2_t)
library(ggplot2)
#tolerance testing
tolerance_stabilisation <- ggplot(tolerance_test, aes(x=Tolerance_factor, y=Coherence)) +
geom_boxplot()
asymmetric$g2_t_factor < - as.factor(asymmetric$g2_t)
#asymmetric tolerance testing
asymmetric %>% group_by(g1_t_factor,g2_t) %>% summarize(m = mean(Similarity), c = mean(Coherence), g1 = mean(Group1_similarity),g2 = mean(Group2_similarity),d = mean(Dimension)) -> asymmetric_average
library(dplyr)
(ggplot2)
library(ggplot2)
#asymmetric tolerance testing
asymmetric %>% group_by(g1_t_factor,g2_t) %>% summarize(m = mean(Similarity), c = mean(Coherence), g1 = mean(Group1_similarity),g2 = mean(Group2_similarity),d = mean(Dimension)) -> asymmetric_average
#asymmetric tolerance testing
asymmetric %>% group_by(g1_t_factor,g2_t) %>% summarize(m = mean(Similaity_ratio), c = mean(Coherence), g1 = mean(g1_similarity),g2 = mean(g2_similarity),d = mean(Dimension)) -> asymmetric_average
print(asymmetric_average)
print(asymmetric_average,n=41)
asymmetric_convergence <- ggplot(average_group_size,aes(x = g2_t, y = c,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
asymmetric_convergence <- ggplot(asymmetric_average,aes(x = g2_t, y = c,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_convergence)
asymmetric_average$diff1 = (average_group_size$g1 - average_group_size$g1_t)
asymmetric_average$diff1 = (asymmetric_average$g1 - asymmetric_average$g1_t)
#asymmetric tolerance testing
asymmetric %>% group_by(g1_t,g2_t) %>% summarize(m = mean(Similaity_ratio), c = mean(Coherence), g1 = mean(g1_similarity),g2 = mean(g2_similarity),d = mean(Dimension)) -> asymmetric_average
print(asymmetric_average,n=41)
asymmetric_average$diff1 = (asymmetric_average$g1 - asymmetric_average$g1_t)
asymmetric_average$diff2 = (asymmetric_average$g2 - asymmetric_average$g2_t)
asymmetric_g1_difference <- ggplot(asymmetric_average,aes(x = g2_t, y = diff1,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_g1_difference)
#asymmetric tolerance testing
asymmetric %>% group_by(g1_t,g2_t) %>% summarize(m = mean(Similaity_ratio), c = mean(Coherence), g1 = mean(g1_similarity),g2 = mean(g2_similarity),d = mean(Dimension)) -> asymmetric_average
asymmetric_average$diff1 = (asymmetric_average$g1 - asymmetric_average$g1_t)
asymmetric_average$diff2 = (asymmetric_average$g2 - asymmetric_average$g2_t)
asymmetric_g1_difference <- ggplot(asymmetric_average,aes(x = g2_t, y = diff1,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_g1_difference)
#asymmetric tolerance testing
asymmetric %>% group_by(g1_t,g2_t) %>% summarize(m = mean(Similaity_ratio), c = mean(Coherence), g1 = mean(g1_similarity),g2 = mean(g2_similarity),d = mean(Dimension)) -> asymmetric_average
asymmetric_convergence <- ggplot(asymmetric_average,aes(x = g2_t, y = c,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_convergence)
asymmetric_convergence <- ggplot(asymmetric_average,aes(x = g2_t, y = c,col=g1_t,shape=g1_t)) + geom_point()
print(asymmetric_convergence)
asymmetric_average$g1_t_factor <- as.factor(asymmetric_average$g1_t)
asymmetric_convergence <- ggplot(asymmetric_average,aes(x = g2_t, y = c,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_convergence)
print(asymmetric_average, n=40)
print(asymmetric_average, n=41)
asymmetric_average$diff1 = (asymmetric_average$g1 - asymmetric_average$g1_t)
asymmetric_average$diff2 = (asymmetric_average$g2 - asymmetric_average$g2_t)
asymmetric_g1_difference <- ggplot(asymmetric_average,aes(x = g2_t, y = diff1,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_g1_difference)
asymmetric_g2_difference <- ggplot(asymmetric_average,aes(x = g2_t, y = diff2,col=g1_t_factor,shape=g1_t_factor)) + geom_point()
print(asymmetric_g2_difference)
minority_test <- read.csv("weak-minority-preferences.csv",header=t)
minority_test <- read.csv("weak-minority-preferences.csv",header=T)
minority <- read.csv("weak-minority-preferences.csv",header=T)
